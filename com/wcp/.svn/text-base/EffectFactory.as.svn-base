package com.wcp {	import flash.utils.ByteArray;	import flash.events.EventDispatcher;	import flash.events.Event;	import flash.events.MouseEvent;	import com.wcp.EffectEvent;	import com.wcp.Effect;	public class EffectFactory extends EventDispatcher {		private var a = new Array();		private var b = new Array();		public var effectName:String = null;		public var library:Object = new Object();		public function make(_effectName:String=null) {			if(this.library[_effectName]!=null){				return this.library[_effectName];			}			return false;		}		private function picker(min=0,max=0):int {			return (Math.round(Math.random()*(max-min))+min);		}		private function confine(val,min,max) {			if(val>max)				val -= max;			else if(val<min)				val += max;			return val;		}		public function cloneObject(o:Object):Object{			var bytes:ByteArray = new ByteArray();				bytes.writeObject(o);				bytes.position = 0;			return bytes.readObject();		}		public function EffectFactory() {			// __________________________________________________			// __________________________________________________			library.strobe = new Effect('strobe');			library.strobe.speed = 2;			library.strobe.hasChannel = false;			a = new Array();b = new Array();			for(i=0;i<60;i++) a.push(i);			for(i=0;i<32;i++) {				if(i%2==0) {				library.strobe.sequence.push(a);				} else {				library.strobe.sequence.push(b);				}			}			// __________________________________________________			// __________________________________________________			library.pulse = new Effect('pulse');			library.pulse.speed = 2;			library.pulse.brightness = 50;			library.pulse.sequence = new Array();			var j = v = 5;			v=5;			while(v<100) {				a = new Array();b = new Array();				for(i=0;i<60;i++) {					a.push(new Array(""+i,v));				}				library.pulse.sequence.push(a);				//v = Math.min( Math.sqrt(j*600),100);				v = Math.min( Math.pow(j,(j*0.05)),100);				j++;			}			v=100;			j=1;			while(v>5) {				a = new Array();b = new Array();				for(i=0;i<60;i++) {					a.push(new Array(""+i,v));				}				library.pulse.sequence.push(a);				//v = Math.max(100-Math.sqrt(j*300),1);				v -= j*(100/60);				j++;				//trace(v);			}			/*a = new Array();b = new Array();			for(i=0;i<60;i++) {				a.push(new Array(""+i,0));			}			library.pulse.sequence.push(a);*/			// __________________________________________________			// __________________________________________________			library.spiral = new Effect('spiral');			library.spiral.sequence = new Array(60);			for(i=0;i<60;i++) {				j=(i%12)*5;				index = j+Math.floor(i/12);				library.spiral.sequence[i] = new Array(index+"");			}			library.spiral2 = new Effect('spiral2');			library.spiral2.trail = 3;			library.spiral2.sequence = new Array();//cloneObject(library.spiral.sequence);			a = new Array(30,35,40,45,50,55,0 ,5 ,10,15,20,25);			for(i=0;i<60;i++) {				index = ((i%12)*5)+Math.floor(i/12);				beam = (i%12);				ring = (i%5);				v = a[beam]+Math.floor(i/12);				library.spiral2.sequence.push(new Array(index,v));			}			//library.spiral2.sequence = a;			/*for(i=59;i>=0;i--) {				j=(11-(i%12))*5;				index = j+Math.floor(i/12);				chaser = confine(index,0,59);				library.spiral2.sequence[(113-i)].push(index);			}*/			library.bouncer = new Effect('bouncer');			library.bouncer.speed = 2;			library.bouncer.sequence = new Array(60);			for(i=0;i<60;i++) {				arm=(i%13)*5;				ring=Math.floor(i/13);				index = arm+ring;				library.bouncer.sequence[i] = new Array(index+"");			}			for(i=0;i<60;i++) {				arm = confine(60-((i%13)*5),0,59);				ring = Math.floor(i/13);				index = arm + ring;				library.bouncer.sequence[i].push(index+"");			}			// __________________________________________________			// __________________________________________________			library.stars = new Effect('stars');			library.stars.speed = 4;			library.stars.trail = 3;			library.stars.hasChannel = false;			/*library.stars.sequence = new Array(10);			var star = Math.floor(Math.random()*6);			for(i=0;i<60;i++) {				frame = (i<30) ? i%5 : (i%5)+5;				beam = Math.floor((i%30)/5);				row = Math.floor(i/5);				index = (i<30) ? ((row+1)*5)-(i%5)-1 : i;				if(beam==star)					library.stars.sequence[frame] = new Array(index+"");			}*/			/*for(i=0;i<10;i++) library.stars.sequence.push(new Array());			for(i=0;i<6;i++) library.stars.sequence[i].push("");			for(i=0;i<60;i++) {				//4,3,2,1,0,30,31,32,33,34				frame = (i<30) ? i%5 : (i%5)+5;				beam = Math.floor((i%30)/5);				row = Math.floor(i/5);				index = (i<30) ? ((row+1)*5)-(i%5)-1 : i;				trace("frame:"+frame+" beam:"+beam + " index:"+index);				library.stars.sequence[frame][beam] = (index+"");			}*/						// __________________________________________________			// __________________________________________________			library.warp = new Effect('warp');			library.warp.trail = 1;			library.warp.loops = 3;			library.warp.sequence = new Array(				new Array(0, 9 ,18,27,36,45,54)				,new Array(1,10,19,28,37,46,55)				,new Array(2,11,20,29,38,47,56)				,new Array(3,12,21,30,39,48,57)				,new Array(4,13,22,31,40,49,58)				,new Array(5,14,23,32,41,50,59)				,new Array(6,15,24,33,42,51)				,new Array(7,16,25,34,43,52)				,new Array(8,17,26,35,44,53)							);			for(frame in library.warp.sequence) {				for(lite in library.warp.sequence[frame]) {					v = library.warp.sequence[frame][lite];					ring = (v%5)+1;					library.warp.sequence[frame][lite] = new Array(v,ring*20);				}			}			library.propeller = new Effect('propeller');			library.propeller.trail = 1;			library.propeller.loops = 3;			library.propeller.sequence = new Array(6);            for(i=0;i<60;i++) {                beam = (i%12);                frame = (i%6);                ring = (i%5);                if(library.propeller.sequence[frame]==null)                    library.propeller.sequence[frame] = new Array();                library.propeller.sequence[frame].push(i);            }			// __________________________________________________			// __________________________________________________			library.rings = new Effect('rings');			library.rings.trail = 2;			//library.rings.sequence.push(new Array());			for(i=0;i<5;i++) library.rings.sequence.push(new Array());			var frame = 0;			for(i=0;i<60;i++) {				frame = (i%5);				index = i+(frame*5);				//trace("i:"+i+" frame:"+frame+" index:"+index);				library.rings.sequence[frame].push(i);			}			library.rings.sequence.push(new Array());						// __________________________________________________			// __________________________________________________			library.clock = new Effect('clock');			library.clock.trail = 3;			row = new Array();			for(i=0;i<60;i++) {				row.push(i);				if(i%5==4) {					library.clock.sequence.push(row);					row = new Array();				}			}			// __________________________________________________			// __________________________________________________			library.twinkle = new Effect('twinkle');			library.twinkle.speed = .25;			library.twinkle.trail = 0;			library.twinkle.brightness = 100;			//library.twinkle.sequence = new Array(10);			for(i=0;i<8;i++) {				library.twinkle.sequence.push(new Array());			}			/*for(i=0;i<library.twinkle.sequence.length;i++){				if(library.twinkle.sequence[i]==undefined)					library.twinkle.sequence[i]=new Array();			}*/			for(i in library.twinkle.sequence){				for(j=0;j<60;j+=3) {					library.twinkle.sequence[i].push(new Array(j,picker(5,100)));				}			}									library.disco = new Effect('disco');			library.disco.speed = 1;			library.disco.trail = 3;			var randomOrder = new Array(1,11,3,7,5,9,2,4,8,0,10,6);			for(i=0;i<60;i++) {				v = (randomOrder[Math.floor(i/5)]*5) + (i%5);				library.disco.sequence.push(new Array(v,100));				//trace(v);			}			/*for(j=0;j<12;j++) {				a = new Array();				for(i=0;i<5;i++) {					a.push((randomOrder[j]*5)+i);				}				library.disco.sequence.push(a);			}*/						library.discoball = new Effect('discoball');			library.discoball.speed = 0.5;			library.discoball.trail = 3;			library.discoball.loops = 8;			library.discoball.hasChannel = false;			/*a = new Array();			for(i=0;i<12;i++) {				a.push(new Array((i*5),50));				a.push(new Array((i*5)+1,50));			}			for(i=0;i<8;i++) {				library.discoball.sequence.push(a);							}*/			a = new Array(30,35,40,45,50,55,0 ,5 ,10,15,20,25);			for(i=0;i<12;i++) {				index = ((i%12)*5)+Math.floor(i/12);				beam = (i%12);				ring = (i%5);				v = a[beam]+Math.floor(i/12);				library.discoball.sequence.push(new Array(index,v));			}					}	}}